# 报警

uav可对所有[监控指标](71.md)进行报警，并提供简单的表达式对监控指标进行报警策略设置。报警表达式触发后可通过[邮件](#邮件)、[短信](#短信)、[HTTP接口](#HTTP接口)三种方式进行报警。

## 预警策略设置 {#预警策略设置}

进入上帝之眼界面，点击左边栏预警策略管理进入[预警策略列表视图](#预警策略列表视图)。

### 预警策略列表视图 {#预警策略列表视图}

![](assets/28_01.png)

##### 1.创建预警按钮 {#创建预警按钮}

点击可创建预警，进入[创建预警界面](#创建)。

##### 2.检索输入框

输入关键字进行检索，关键字以"\*"结尾可以模糊匹配。

##### 3.检索按钮

点击开始检索。

##### 4.显示全部按钮

点击可显示全部预警策略。

##### 5.预警策略概览栏 {#预警策略概览栏}

点击任意区域可[查看](#查看)预警策略详情（若策略属于用户，则进入[修改](#修改)界面）。  
**策略**：显示策略简介。第一栏表示策略类型；第二栏表示监控指标类型；第三栏表示策略应用实例或应用实例组。  
**描述**：显示策略的描述。  
**归属用户**：显示策略的归属用户。用户对属于自己的策略有[查看](#查看)、[修改](#修改)和[删除](#删除)的权限，对不属于自己的策略只有查看权限。  
**修改时间**：策略最后更新的时间。

##### 6.删除按钮

点击![](assets/28_13.png)删除策略，该操作无法撤销。

### 创建 {#创建}

点击预警策略列表视图中[创建预警按钮](#创建预警按钮)进入添加策略页面。点击添加策略页面右上角![](assets/28_03.png)打开预警设置帮助文档，点击![](/assets/28_16.png)退出到预警策略列表视图。  
![](/assets/28_02.png)

##### 1.选择监控组

点击1处图标打开下拉选择框，如下图，选择[监控组](71.md)。  
![](/assets/28_04.jpg)

##### 2.选择监控组指标系

选择监控组后，会增加一栏监控组指标系，点击右侧按钮打开下拉菜单框，如下图，选择[监控组指标系](#监控组指标系)。  
![](/assets/28_05.jpg)

##### 3.输入实例名或实例组名

可直接输入实例名，若有多个实例，则输入实例组名，在下一栏输入实例名。实例名填写方式如下表。

| 监控指标系名 | 实例名 | 示例 |
| --- | --- | --- |
| 自定义指标 | 服务器地址 | http://10.143.129.64:8080 或jse://10.120.68.73/com.alibaba.rocketmq.namesrv.NamesrvStartup-8902 |
| 进程状态指标系 | IP\_进程名或IP | 10.100.33.136\_java |
| 容器状态指标系 | 具体IP | 10.100.33.136 |
| 服务状态指标系 | 具体服务url地址或上级地址 | http://10.143.129.64:8080/isign/isign/signPDF |
| 应用状态指标系 | 应用地址 | http://10.143.129.64:8080/isign |
| 应用服务器状态指标系 | 服务器地址 | http://10.143.129.64:8080 |
| 调用状态指标系 | 服务器ip:端口\#应用实例名\#调用服务类型\(redis,http,mongo,mysql等\)://调用服务ip:端口 | 10.100.30.73:9090\#smsmanager\#redis://10.100.30.73:6379 |
| 日志指标 | 日志文件位置 | /app/t7-ccsp/logs/ccsp.log |

##### 4.输入实例名

若上一栏为实例名此栏不填写，若上一栏为实例组名，此栏填写实例名，多个实例名间用","分隔。

##### 5.输入描述

此策略的描述，用户自定义。

##### 6.条件定义

点击![](assets/28_12.png)添加条件定义，如下图。  
![](/assets/28_07.jpg)

* 第一栏填写触发表达式，形式为 \[[监控指标名](71.md)\]\[比较符\]\[值\]，比较符有&lt; 、 &gt; 、 =，示例：os.cpu.load&gt;90。对于每种监控指标组名，只能使用对应的监控名。监控指标组名与指标参数名的对应关系见[监控指标说明](71.md)。
* 第二栏填写持续时间，表示策略判断的时间长度，单位为秒。（可不填，不填表示表达式条件发生则触发预警）。
* 第三栏选择聚集操作，表示对持续时间范围内的参数值做的聚集操作类型。

条件定义示例图如下，表示一分钟内os.cpu.load\(容器cpu使用率\)的平均值大于90。  
![](/assets/28_06.jpg)

##### 7.触发策略

条件定义添加后，点击![](assets/28_12.png)添加触发策略，如下图。  
![](/assets/28_14.jpg)

点击条件定义表达式添加进编辑框，在条件定义表达式之间添加\(&&\)\|\|符号表示条件定义之间的逻辑关系，示例如下图。
![](/assets/28_15.jpg)

##### 8.触发动作

点击![](assets/28_12.png)添加触发动作，如下图。  
![](/assets/28_08.jpg)

* 第一栏选择触发动作类型，有邮件、短信、HTTP调用三种类型可选。
* 第二栏为通知对象，动作类型对应的通知对象分别为邮箱地址、手机号码、HTTP调用地址。多个通知对象间用","隔开。

点击添加优先级添加一栏通知对象，可添加多个，优先级从高至低。

![](/assets/28_11.jpg)

##### 9.创建完成

点击保存按钮完成创建，并跳回策略列表视图界面。

### 查看 {#查看}

用户点击不属于自己的[预警策略概览](#预警策略概览栏)进入预警查看界面。  
![](/assets/28_09.jpg)  
点击触发条件或触发动作右侧图标可查看策略详细配置。

### 修改 {#修改}

用户点击属于自己的预警策略[预警策略概览](#预警策略概览栏)进入预警修改界面。  
![](/assets/28_10.jpg)

* 可修改部分有实例名、策略描述、条件定义、触发动作。
* 实例名&策略描述：直接在输入框内修改。
* 触发条件&触发动作：点击![](assets/28_12.png)增加条件\(动作\)，点击![](assets/28_11.png)修改条件\(动作\)，点击![](assets/28_13.png)删除条件\(动作\)。

### 删除 {#删除}

点击预警列表视图中[预警概览栏](#预警策略概览栏)右侧![](assets/28_13.png)图标删除策略。

